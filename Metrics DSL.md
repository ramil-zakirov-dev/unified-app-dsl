# Metrics DSL — Документация

Metrics DSL — это декларативный слой для описания ключевых метрик в приложении, связанных с поведением, эффективностью, конверсиями, а также A/B тестированием.

---

## Цели

* Однозначное описание метрик для продукта
* Вынос аналитики в отдельный слой
* Возможность интеграции с GA4, Amplitude, Mixpanel, и др.
* Связь с Test DSL, Behavior DSL, Product DSL

---

## Синтаксис

### Объявление метрики

```dsl
метрика КонверсияЗаказа {
  описание: "Доля пользователей, оформивших заказ"
  тип: процент
  источники: [событие: ЗаказУспешный, событие: СтартПокупки]
  формула: ЗаказУспешный / СтартПокупки
  цели: [ { таргет: 70%, период: неделя } ]
}
```

### Время отклика

```dsl
метрика ВремяОтклика {
  единица: секунды
  формула: ЗаказПринят.время - ЗаказСоздан.время
}
```

### Сегменты

```dsl
сегмент АктивныеПользователи {
  фильтр: воход < 7 дней назад
}
```

---

## Атрибуты

| Атрибут    | Описание                                   |
| ---------- | ------------------------------------------ |
| `тип`      | величина, процент, сумма, счетчик, время   |
| `единица`  | дни, секунды, рубли, пользователи и т.д.   |
| `цели`     | целевые значения, периоды                  |
| `сегменты` | фильтры для фокуса на определённых группах |

---

## Интеграции

* С **Behavior DSL**: источники метрик — события поведения
* С **Test DSL**: каждому тесту присваиваются контрольные метрики
* С **Product DSL**: связь по ключевым OKR/целям

---

## Перспективы

* Генерация конфигов для Amplitude, GA4, Mixpanel
* Связь с графиками и дашбордами
* Отслеживание динамики и событий по времени

---
